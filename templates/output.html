<html>
<head>
<style>
h1 {
    background-color:SkyBlue
}
h2 {
    background-color:Silver
}
</style>
<title>GMRTD</title>
</head>
<body>

{{define "fileHexAndTlv"}}
<div><pre>
{{. | BytesToHex}}
</pre></div>

<div><pre>
{{. | TlvBytesToString}}
</pre></div>
{{end}}

{{define "fileHex"}}
<div><pre>
{{. | BytesToHex}}
</pre></div>
{{end}}

<h1><a href="https://github.com/gmrtd/gmrtd">GMRTD</a></h1>

<a href="#json">JSON</a>

<div><pre>
LDS version: <b>{{.LdsVersion}}</b>
Unicode version: <b>{{.UnicodeVersion}}</b>
</pre></div>

<div><pre>
ChipAuthStatus: <b>{{.ChipAuthStatus}}</b>
</pre></div>

<div><pre>
ATR: {{.Atr | BytesToHex}}
ATS: {{.Ats | BytesToHex}}
</pre></div>

<h2>Passive Authentication <sub>SOD</sub></h2>
{{if .PassiveAuthSOD}}
    {{ range .PassiveAuthSOD.CertChain }}
        {{template "fileHexAndTlv" .}}
    {{ end }}
{{else}}
<i>No data</i>
{{end}}

<h2>Passive Authentication <sub>CardSecurity</sub></h2>
{{if .PassiveAuthCardSec}}
    {{ range .PassiveAuthCardSec.CertChain }}
        {{template "fileHexAndTlv" .}}
    {{ end }}
{{else}}
<i>No data</i>
{{end}}

<h2>CardAccess</h2>
{{if .Mf.CardAccess}}
{{template "fileHexAndTlv" .Mf.CardAccess.RawData}}
{{else}}
<i>No data</i>
{{end}}

<h2>CardSecurity</h2>
{{if .Mf.CardSecurity}}
{{template "fileHexAndTlv" .Mf.CardSecurity.RawData}}
{{else}}
<i>No data</i>
{{end}}

<h2>DIR</h2>
{{if .Mf.Dir}}
{{template "fileHexAndTlv" .Mf.Dir.RawData}}
{{else}}
<i>No data</i>
{{end}}

<h2>COM</h2>
{{if .Mf.Lds1.Com}}
{{template "fileHexAndTlv" .Mf.Lds1.Com.RawData}}
{{else}}
<i>No data</i>
{{end}}

<h2>SOD <sub>Document Security Object</sub></h2>
{{if .Mf.Lds1.Sod}}
{{template "fileHexAndTlv" .Mf.Lds1.Sod.RawData}}
{{else}}
<i>No data</i>
{{end}}

{{template "dg1" .Mf.Lds1.Dg1}}
{{template "dg2" .Mf.Lds1.Dg2}}
{{template "dg7" .Mf.Lds1.Dg7}}
{{template "dg11" .Mf.Lds1.Dg11}}
{{template "dg12" .Mf.Lds1.Dg12}}
{{template "dg13" .Mf.Lds1.Dg13}}
{{template "dg14" .Mf.Lds1.Dg14}}
{{template "dg15" .Mf.Lds1.Dg15}}
{{template "dg16" .Mf.Lds1.Dg16}}

<h1>APDU LOG</h1>

<h2>Count: {{len .Apdus}}</h2>
<h2>Duration(ms): {{.Apdus | ApduTotalDurMs}}</h2>

{{ range .Apdus }}
<div><pre>
Desc: <b>{{ .Desc }}</b>
Dur(ms): <b>{{ .DurMs }}</b>
</pre></div>
<div><pre>
-> {{ .Tx | BytesToHex }}
    {{if .Child}}
--> {{ .Child.Tx | BytesToHex }}
<-- {{ .Child.Rx | BytesToHex }}
    {{end}}
<- {{ .Rx | BytesToHex }}
</pre></div>
<hr>
{{ end }}

<div id="json">
<h1>Document JSON</h1>

<div><pre>
{{ .IndentedJson }}
</pre></div>
</div>

</body>
</html>
